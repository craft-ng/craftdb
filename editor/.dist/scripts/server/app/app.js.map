{"version":3,"sources":["server/app/app.ts"],"names":[],"mappings":";AAAA,MAAO,GAAG,WAAW,KAAK,CAAC,CAAC;AAC5B,sBAAkB,uBAAuB,CAAC,CAAA;AAE1C,MAAO,IAAI,WAAW,MAAM,CAAC,CAAC;AAC9B,8BAAyB,4BAA4B,CAAC,CAAA;AACtD,MAAO,IAAI,WAAW,MAAM,CAAC,CAAC;AAC9B,MAAM,WAAW,GAAG,OAAO,CAAC,YAAY,CAAC,CAAC;AAC1C,MAAM,QAAQ,GAAG,OAAO,CAAC,cAAc,CAAC,CAAC;AAEzC,IAAI,QAAQ,CAAC;AAEb,wBAAU,CACN,IAAI,CAAC,OAAO,CAAC,SAAS,EAAE,8BAA8B,CAAC,EACvD,OAAO,IAAI,QAAQ,GAAG,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,CAC5C,CAAC;AAEF,IAAI,kBAAkB,GAAG;IACrB,MAAM,EAAE,EAAE;IACV,MAAM,EAAE,IAAI;CACf,CAAC;AACF,kBAAkB,GAAG,IAAI,CAAC;AAE1B,MAAM,GAAG,GAAQ,IAAI,GAAG,EAAE,CAAC;AAC3B,GAAG,CAAC,GAAG,CAAC,QAAQ,CAAC;IACb,KAAK,EAAE,IAAI,CAAC,YAAY;CAC3B,CAAC,CAAC,CAAC;AACJ,GAAG,CAAC,GAAG,CAAC,CAAC,GAAgB,EAAE,IAAI;IAC3B,MAAM,CAAC,IAAI,EAAE,CAAC,IAAI,CAAC;QACf,GAAG,CAAC,GAAG,CAAC,eAAe,EAAE,kBAAkB,CAAC,CAAC,CAAC,SAAS;IAC3D,CAAC,CAAC,CAAC;IACH,wCAAwC;AAC5C,CAAC,CAAC,CAAC;AACH,GAAG,CAAC,GAAG,CAAC,WAAW,CAAC,MAAM,EAAE,kBAAkB,CAAC,CAAC,CAAC;AAEjD,IAAI,GAAG,GAAG,IAAI,SAAG,EAAE,CAAC;AACpB,GAAG,CAAC,aAAa,CAAC,SAAS,EAAE,CAAC,QAAQ,EAAE,OAAO,CAAC,EAAE;IAC9C,KAAK,EAAE;QACH,SAAS,EAAE,KAAK;QAChB,MAAM,EAAE,KAAK;QACb,eAAe,EAAE;YACb,OAAO,EAAE,0BAA0B;YACnC,IAAI,EAAE;gBACF,QAAQ,EAAE,QAAQ;aACrB;YACD,MAAM,EAAE;gBACJ,YAAY,EAAE,MAAM,IAAI,QAAQ,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC;gBAC9C,WAAW,EAAE,MAAM,IAAI,QAAQ,CAAC,MAAM,CAAC,CAAC,KAAK,CAAC;aACjD;SACJ;KACJ;CACJ,CAAC,CAAC;AACH,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC,MAAM,EAAE,CAAC,CAAC;AACtB,GAAG,CAAC,GAAG,CAAC,QAAQ,CAAC;IACb,KAAK,EAAE,IAAI,CAAC,YAAY;CAC3B,CAAC,CAAC,CAAC;AAEJ,GAAG,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC","file":"server/app/app.js","sourcesContent":["import Koa = require('koa');\nimport {Mvc} from \"../koa-mvc-server/Mvc\";\nimport mount = require('koa-mount');\nimport zlib = require('zlib');\nimport {fileReload} from '../file-reload/file-reload';\nimport path = require('path');\nconst serveStatic = require('koa-static');\nconst compress = require('koa-compress');\n\nvar manifest;\n\nfileReload(\n    path.resolve(__dirname, '../../../webpack-assets.json'),\n    content => manifest = JSON.parse(content)\n);\n\nvar serveStaticOptions = {\n    maxAge: 30,\n    buffer: true\n};\nserveStaticOptions = null;\n\nconst app: Koa = new Koa();\napp.use(compress({\n    flush: zlib.Z_SYNC_FLUSH\n}));\napp.use((ctx: Koa.Context, next)=> {\n    return next().then(() => {\n        ctx.set('Cache-Control', 'max-age=31536000'); // 1 year\n    });\n    // ctx.set('Cache-Control', 'no-cache');\n});\napp.use(serveStatic('.www', serveStaticOptions));\n\nvar mvc = new Mvc();\nmvc.registerAreas(__dirname, ['/admin', '/home'], {\n    views: {\n        extension: 'pug',\n        engine: 'pug',\n        templateOptions: {\n            basedir: '.dist/scripts/server/app',\n            meta: {\n                manifest: manifest,\n            },\n            render: {\n                scriptSource: bundle => manifest[bundle]['js'],\n                styleSource: bundle => manifest[bundle]['css']\n            }\n        }\n    }\n});\napp.use(mvc.routes());\napp.use(compress({\n    flush: zlib.Z_SYNC_FLUSH\n}));\n\napp.listen(3010);"],"sourceRoot":"/src"}